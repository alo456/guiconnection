{% extends 'base.html.twig' %}
{% block title %}
    Categorias
{% endblock %}
{% block classBody 'app header-fixed sidebar-fixed aside-menu-fixed aside-menu-hidden aside-menu-off-canvas' %}
{% block body %}
<main class="main">
    
    <br>
    <div class="container-fluid">
        <div class="animated fadeIn">
            <!-- Page Header-->
            <div class="jumbotron jumbotron-fluid">
                <div class="container">
                    <h3 class="display-4">Vamos a crear la categorias de tu menu</h3>
                    <p class="lead">Crea categorias y subcategorias de tu menu</p>
                    {% if message is not empty %}
                        <p class="lead"> <b>{{message}}</b> </p>
                    {% endif %}    
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-6 mb-4">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#create" role="tab" aria-controls="tablas"><i class="fa fa-file-text-o"></i>Crear</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#exist" role="tab" aria-controls="graficas"><i class="fa fa-bar-chart"></i>Existentes</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="create" role="tabpanel">
                            <div class="animated fadeIn">
                                <div class="card">
                                    <div class="card-header">
                                        <h4 class="card-title">Información del producto</h4>
                                    </div>
                                    <div class="card-body">
                                        {{ form_start(formCreateMenu) }}
                                        {{ form_end(formCreateMenu) }}
                                        <hr/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="exist" role="tabpanel">
                            <div class="animated fadeIn">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-12 mb-4">
                                                <!-- TABLAS -->
                                                <table id="jqGrid" class= "table table-responsive-sm table-hover table-outline mb-0 ">
                                                    
   
                                                </table>
                                                <div id="jqGridPager"></div>
                                            </div>
                                        </div>
                                        <hr/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>                              
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block javascripts %}
    <script src="{{asset('vendors/js/jquery.jqGrid.js')}}"></script>
    <script>
		$.jgrid.defaults.width = 780;
		$.jgrid.defaults.responsive = true;
		$.jgrid.defaults.styleUI = 'Bootstrap';
    </script>
    <script type="text/javascript"> 
    
        $(document).ready(function () {
            $("#jqGrid").jqGrid({
                url: 'http://localhost/guiconnection/public/test.json',
                mtype: "GET",
                datatype: "json",
                page: 1,
                colModel: [
                    { label: 'Nombre del Menú', name: 'name', width: 150 },
                    { label: 'Descripción', name: 'description', width: 150 }
                ],
                loadonce: true,
                width: 780,
                height: 250,
                rowNum: 20,
                subGrid: true, // set the subGrid property to true to show expand buttons for each row
                subGridRowExpanded: showChildGrid, // javascript function that will take care of showing the child grid
                pager: "#jqGridPager"
            });
        });

        // the event handler on expanding parent row receives two parameters
        // the ID of the grid tow  and the primary key of the row
        function showChildGrid(parentRowID, parentRowKey) {
            consolelog("gosas");
            var childGridID = parentRowID + "_table";
            var childGridPagerID = parentRowID + "_pager";

            // send the parent row primary key to the server so that we know which grid to show
            var childGridURL = parentRowKey+".json";

            // add a table and pager HTML elements to the parent grid row - we will render the child grid here
            $('#' + parentRowID).append('<table id=' + childGridID + '></table><div id=' + childGridPagerID + ' class=scroll></div>');

            $("#" + childGridID).jqGrid({
                url: childGridURL,
                mtype: "GET",
                datatype: "json",
                page: 1,
                colModel: [
                    { label: 'Order ID', name: 'OrderID', key: true, width: 75 },
                    { label: 'Required Date', name: 'RequiredDate', width: 100 },
                    { label: 'Ship Name', name: 'ShipName', width: 100 },
                    { label: 'Ship City', name: 'ShipCity', width: 100 },
                    { label: 'Freight', name: 'Freight', width: 75 }
                ],
                                loadonce: true,
                width: '600',
                height: '150',
                subGrid: true, // set the subGrid property to true to show expand buttons for each row
                subGridRowExpanded: showThirdLevelChildGrid, // javascript function that will take care of showing the child grid
                pager: "#" + childGridPagerID
            });

        }

        // the event handler on expanding parent row receives two parameters
        // the ID of the grid tow  and the primary key of the row
        function showThirdLevelChildGrid(parentRowID, parentRowKey) {
            var childGridID = parentRowID + "_table";
            var childGridPagerID = parentRowID + "_pager";

            // send the parent row primary key to the server so that we know which grid to show
            var childGridURL = "child3.json";

            // add a table and pager HTML elements to the parent grid row - we will render the child grid here
            $('#' + parentRowID).append('<table id=' + childGridID + '></table><div id=' + childGridPagerID + ' class=scroll></div>');

            $("#" + childGridID).jqGrid({
                url: childGridURL,
                mtype: "GET",
                datatype: "json",
                colModel: [
                    { label: 'Order ID', name: 'OrderID', key: true, width: 75, hidden: true },
                    { label: 'Product ID', name: 'ProductID', width: 100 },
                                        { label: 'Quantity', name: 'Quantity', width: 100},
                    {label: 'Unit Price', name: 'UnitPrice', width: 100},
                    {
                        label: 'Total',
                        name: 'Total',
                        width: 100,
                        sortable: false,
                        formatter: function (cellValue, options, row) {   // custom calculations at client side
                            return parseFloat(row.Quantity) * parseFloat(row.UnitPrice);
                        }
                    }
                ],
                loadonce: true,
                width: 'auto',
                height: '150',
                pager: "#" + childGridPagerID
            });

        }

    </script>
{% endblock %}
{% block stylesheets %}
    <link href="{{asset('vendors/css/ui.jqgrid-bootstrap.css')}}" rel="stylesheet">
{% endblock %}